 BComm = {}; BComm.BLCOM_113592aa3daac596007c6988087b5d8a = {}; local BLCOM_432894f39d56c354b47ebab13b5ddc8e = 1; local BLCOM_a1c7632dee62bf2476eb00394fc2b049 = 0; function BComm.BLCOM_b58b8fba3f8504434134d0578ff98784(BLCOM_7b94c1c8f83894a3af44cde3aa45b8a8) if (not BLCOM_7b94c1c8f83894a3af44cde3aa45b8a8) then return "$n"; end local BLCOM_4c1dd438f83167de62aa6b3f4e5bad9a = BLCOM_7b94c1c8f83894a3af44cde3aa45b8a8; BLCOM_4c1dd438f83167de62aa6b3f4e5bad9a = string.gsub(BLCOM_4c1dd438f83167de62aa6b3f4e5bad9a, "$", "$$"); BLCOM_4c1dd438f83167de62aa6b3f4e5bad9a = string.gsub(BLCOM_4c1dd438f83167de62aa6b3f4e5bad9a, "^", "$s"); BLCOM_4c1dd438f83167de62aa6b3f4e5bad9a = string.gsub(BLCOM_4c1dd438f83167de62aa6b3f4e5bad9a, "\n", "$r"); BLCOM_4c1dd438f83167de62aa6b3f4e5bad9a = string.gsub(BLCOM_4c1dd438f83167de62aa6b3f4e5bad9a, "\t", "$t"); return BLCOM_4c1dd438f83167de62aa6b3f4e5bad9a; end function BComm.BLCOM_aebbd0e4d8adb065af7d75044bc0ed1b(BLCOM_7b94c1c8f83894a3af44cde3aa45b8a8) if (BLCOM_7b94c1c8f83894a3af44cde3aa45b8a8 == "$n") then return nil; end local BLCOM_4c1dd438f83167de62aa6b3f4e5bad9a = BLCOM_7b94c1c8f83894a3af44cde3aa45b8a8; BLCOM_4c1dd438f83167de62aa6b3f4e5bad9a = string.gsub(BLCOM_4c1dd438f83167de62aa6b3f4e5bad9a, "$t", "\t"); BLCOM_4c1dd438f83167de62aa6b3f4e5bad9a = string.gsub(BLCOM_4c1dd438f83167de62aa6b3f4e5bad9a, "$r", "\n"); BLCOM_4c1dd438f83167de62aa6b3f4e5bad9a = string.gsub(BLCOM_4c1dd438f83167de62aa6b3f4e5bad9a, "$s", "^"); BLCOM_4c1dd438f83167de62aa6b3f4e5bad9a = string.gsub(BLCOM_4c1dd438f83167de62aa6b3f4e5bad9a, "$$", "$"); return BLCOM_4c1dd438f83167de62aa6b3f4e5bad9a; end function BComm.BLCOM_b162f4f29f2727948334a3a08e348df9(BLCOM_93a5a1bb3574aa524691d5b46e5deff9, ...) assert(BLCOM_93a5a1bb3574aa524691d5b46e5deff9 and type(BLCOM_93a5a1bb3574aa524691d5b46e5deff9) == "string", "Invalid parameter."); local BLCOM_eed0be1c2d5f65980b06b5094460c3c5; local __index, BLCOM_2361bab8b48b1041ad740bb561b21aee; BLCOM_eed0be1c2d5f65980b06b5094460c3c5 = BComm.BLCOM_b58b8fba3f8504434134d0578ff98784(BLCOM_93a5a1bb3574aa524691d5b46e5deff9); for __index, BLCOM_2361bab8b48b1041ad740bb561b21aee in ipairs(arg) do BLCOM_eed0be1c2d5f65980b06b5094460c3c5 = BLCOM_eed0be1c2d5f65980b06b5094460c3c5 .. "^" .. BComm.BLCOM_b58b8fba3f8504434134d0578ff98784(BLCOM_2361bab8b48b1041ad740bb561b21aee); end return BLCOM_eed0be1c2d5f65980b06b5094460c3c5; end function BComm.BLCOM_86d0655a5ab14a6b6bb8c0dad13f111a(BLCOM_eed0be1c2d5f65980b06b5094460c3c5) local BLCOM_6e4d0db7491d6883f86de390d20dbe5b, BLCOM_a2f3972c23a0aa3bd7fb0e9823d918f2; local BLCOM_93a5a1bb3574aa524691d5b46e5deff9; local BLCOM_40f9b0bf3fe9bf18d0208cf9e08f55b4 = 1; local BLCOM_82fe1875255a3baf828b1a49a1270de9 = {n = 0}; BLCOM_6e4d0db7491d6883f86de390d20dbe5b, BLCOM_a2f3972c23a0aa3bd7fb0e9823d918f2 = string.find(BLCOM_eed0be1c2d5f65980b06b5094460c3c5, "^", BLCOM_40f9b0bf3fe9bf18d0208cf9e08f55b4); if (BLCOM_6e4d0db7491d6883f86de390d20dbe5b and BLCOM_a2f3972c23a0aa3bd7fb0e9823d918f2) then BLCOM_93a5a1bb3574aa524691d5b46e5deff9 = BComm.BLCOM_aebbd0e4d8adb065af7d75044bc0ed1b(string.strsub(BLCOM_eed0be1c2d5f65980b06b5094460c3c5, BLCOM_40f9b0bf3fe9bf18d0208cf9e08f55b4, BLCOM_6e4d0db7491d6883f86de390d20dbe5b - BLCOM_40f9b0bf3fe9bf18d0208cf9e08f55b4)); BLCOM_40f9b0bf3fe9bf18d0208cf9e08f55b4 = BLCOM_6e4d0db7491d6883f86de390d20dbe5b + 1; BLCOM_6e4d0db7491d6883f86de390d20dbe5b, BLCOM_a2f3972c23a0aa3bd7fb0e9823d918f2 = string.find(BLCOM_eed0be1c2d5f65980b06b5094460c3c5, "^", BLCOM_40f9b0bf3fe9bf18d0208cf9e08f55b4); while (BLCOM_6e4d0db7491d6883f86de390d20dbe5b and BLCOM_a2f3972c23a0aa3bd7fb0e9823d918f2) do local BLCOM_7b94c1c8f83894a3af44cde3aa45b8a8 = string.strsub(BLCOM_eed0be1c2d5f65980b06b5094460c3c5, BLCOM_40f9b0bf3fe9bf18d0208cf9e08f55b4, BLCOM_6e4d0db7491d6883f86de390d20dbe5b - BLCOM_40f9b0bf3fe9bf18d0208cf9e08f55b4); table.insert(BLCOM_82fe1875255a3baf828b1a49a1270de9, BComm.BLCOM_aebbd0e4d8adb065af7d75044bc0ed1b(BLCOM_7b94c1c8f83894a3af44cde3aa45b8a8)); BLCOM_40f9b0bf3fe9bf18d0208cf9e08f55b4 = BLCOM_6e4d0db7491d6883f86de390d20dbe5b + 1; BLCOM_6e4d0db7491d6883f86de390d20dbe5b, BLCOM_a2f3972c23a0aa3bd7fb0e9823d918f2 = string.find(BLCOM_eed0be1c2d5f65980b06b5094460c3c5, "^", BLCOM_40f9b0bf3fe9bf18d0208cf9e08f55b4); end else BLCOM_93a5a1bb3574aa524691d5b46e5deff9 = BComm.BLCOM_aebbd0e4d8adb065af7d75044bc0ed1b(BLCOM_eed0be1c2d5f65980b06b5094460c3c5); end return BLCOM_93a5a1bb3574aa524691d5b46e5deff9, BLCOM_82fe1875255a3baf828b1a49a1270de9; end function BComm.BLCOM_1d10ffc99e6f0c5b8f70c21b0b307a4a(BLCOM_d0708241b607c9a9dd1953c812fadfb7) if (BLCOM_d0708241b607c9a9dd1953c812fadfb7 == "CHAT_MSG_ADDON" and BComm.BLCOM_113592aa3daac596007c6988087b5d8a[arg1]) then local BLCOM_93a5a1bb3574aa524691d5b46e5deff9, BLCOM_7739b813d90aed43ab9d0eb84ec1c1ae = BComm.BLCOM_86d0655a5ab14a6b6bb8c0dad13f111a(arg2); if (BComm.BLCOM_113592aa3daac596007c6988087b5d8a[arg1][BLCOM_93a5a1bb3574aa524691d5b46e5deff9]) then local __index, BLCOM_c31af5fd9021206e921af3d99e5a90af; for __index, BLCOM_c31af5fd9021206e921af3d99e5a90af in ipairs(BComm.BLCOM_113592aa3daac596007c6988087b5d8a[arg2][BLCOM_93a5a1bb3574aa524691d5b46e5deff9]) do BLCOM_c31af5fd9021206e921af3d99e5a90af(BLCOM_93a5a1bb3574aa524691d5b46e5deff9, unpack(BLCOM_7739b813d90aed43ab9d0eb84ec1c1ae)); end end end end BComm.BLCOM_411b8aa6d5954c6020f0b9c9e80e847a = CreateFrame("Frame", "BCommFrame", UIParent); BComm.BLCOM_411b8aa6d5954c6020f0b9c9e80e847a:SetWidth(1); BComm.BLCOM_411b8aa6d5954c6020f0b9c9e80e847a:SetHeight(1); BComm.BLCOM_411b8aa6d5954c6020f0b9c9e80e847a:SetPoint("TOPLEFT", "UIParent", "TOPLEFT", 0, 0); BComm.BLCOM_411b8aa6d5954c6020f0b9c9e80e847a:Show(); BComm.BLCOM_411b8aa6d5954c6020f0b9c9e80e847a:RegisterEvent("CHAT_MSG_ADDON"); BComm.BLCOM_411b8aa6d5954c6020f0b9c9e80e847a:SetScript("OnEvent", function () BComm.BLCOM_1d10ffc99e6f0c5b8f70c21b0b307a4a(event); end); function BComm:constructor(BLCOM_f9da61d0483af6cef16512c8cc1a8586, BLCOM_a636447a4c34c16498e0f9d1b42ad9b1, BLCOM_8e2d4ef9193eed09cc6ce5849fad1f0a) assert(BLCOM_f9da61d0483af6cef16512c8cc1a8586 and type(BLCOM_f9da61d0483af6cef16512c8cc1a8586) == "string", "The module must be type of string."); assert(BLCOM_a636447a4c34c16498e0f9d1b42ad9b1 and type(BLCOM_a636447a4c34c16498e0f9d1b42ad9b1) == "string", "The channel must be one of values PARTY, RAID, GUILD, INSTANCE_CHAT."); assert(not BLCOM_8e2d4ef9193eed09cc6ce5849fad1f0a or BLCOM_8e2d4ef9193eed09cc6ce5849fad1f0a == "BULK" or BLCOM_8e2d4ef9193eed09cc6ce5849fad1f0a == "NORMAL" or BLCOM_8e2d4ef9193eed09cc6ce5849fad1f0a == "ALERT", "Invalid priority, priority must be BULK, NORMAL or ALERT."); self.BLCOM_f9da61d0483af6cef16512c8cc1a8586 = BLCOM_f9da61d0483af6cef16512c8cc1a8586; if (BLCOM_a636447a4c34c16498e0f9d1b42ad9b1) then self.BLCOM_a636447a4c34c16498e0f9d1b42ad9b1 = BLCOM_a636447a4c34c16498e0f9d1b42ad9b1; else self.BLCOM_a636447a4c34c16498e0f9d1b42ad9b1 = "RAID"; end if (BLCOM_8e2d4ef9193eed09cc6ce5849fad1f0a) then self.BLCOM_8e2d4ef9193eed09cc6ce5849fad1f0a = BLCOM_8e2d4ef9193eed09cc6ce5849fad1f0a; else slef.BLCOM_8e2d4ef9193eed09cc6ce5849fad1f0a = "NORMAL"; end end function BComm:RegisterCommandListener(BLCOM_93a5a1bb3574aa524691d5b46e5deff9, BLCOM_e8d1c4de4866d23b1ded92f8ba563566) assert(BLCOM_93a5a1bb3574aa524691d5b46e5deff9 and type(BLCOM_93a5a1bb3574aa524691d5b46e5deff9) == "string", "Invalid parameter."); assert(BLCOM_57ad665d0e8800ab56a0e07f8ae9c063 and type(BLCOM_57ad665d0e8800ab56a0e07f8ae9c063) == "function", "Invalid parameter."); if (not BComm.BLCOM_113592aa3daac596007c6988087b5d8a[self.BLCOM_f9da61d0483af6cef16512c8cc1a8586]) then BComm.BLCOM_113592aa3daac596007c6988087b5d8a[BLCOM_c933410cf37b41b19e2f71899bab1b9b.BLCOM_cfcec55a76d72def1c8adbb3a2ddae1c] = {}; end if (not BComm.BLCOM_113592aa3daac596007c6988087b5d8a[self.BLCOM_cfcec55a76d72def1c8adbb3a2ddae1c][BLCOM_93a5a1bb3574aa524691d5b46e5deff9]) then BComm.BLCOM_113592aa3daac596007c6988087b5d8a[self.BLCOM_cfcec55a76d72def1c8adbb3a2ddae1c][BLCOM_93a5a1bb3574aa524691d5b46e5deff9] = {n = 0}; end local __index, BLCOM_2361bab8b48b1041ad740bb561b21aee; for __index, BLCOM_2361bab8b48b1041ad740bb561b21aee in ipairs(BComm.BLCOM_113592aa3daac596007c6988087b5d8a[self.BLCOM_cfcec55a76d72def1c8adbb3a2ddae1c][BLCOM_93a5a1bb3574aa524691d5b46e5deff9]) do if (BLCOM_2361bab8b48b1041ad740bb561b21aee == BLCOM_57ad665d0e8800ab56a0e07f8ae9c063) then return; end end table.insert(BComm.BLCOM_113592aa3daac596007c6988087b5d8a[self.BLCOM_cfcec55a76d72def1c8adbb3a2ddae1c][BLCOM_93a5a1bb3574aa524691d5b46e5deff9], BLCOM_57ad665d0e8800ab56a0e07f8ae9c063); end function BComm:UnregisterCommandListener(BLCOM_93a5a1bb3574aa524691d5b46e5deff9, BLCOM_57ad665d0e8800ab56a0e07f8ae9c063) assert(BLCOM_93a5a1bb3574aa524691d5b46e5deff9 and type(BLCOM_93a5a1bb3574aa524691d5b46e5deff9) == "string", "Invalid parameter."); assert(not BLCOM_57ad665d0e8800ab56a0e07f8ae9c063 or type(BLCOM_57ad665d0e8800ab56a0e07f8ae9c063) == "function", "Invalid parameter."); if (not BComm.BLCOM_113592aa3daac596007c6988087b5d8a[self.BLCOM_f9da61d0483af6cef16512c8cc1a8586]) then BComm.BLCOM_113592aa3daac596007c6988087b5d8a[BLCOM_c933410cf37b41b19e2f71899bab1b9b.BLCOM_cfcec55a76d72def1c8adbb3a2ddae1c] = {}; end if (not BComm.BLCOM_113592aa3daac596007c6988087b5d8a[self.BLCOM_cfcec55a76d72def1c8adbb3a2ddae1c][BLCOM_93a5a1bb3574aa524691d5b46e5deff9]) then BComm.BLCOM_113592aa3daac596007c6988087b5d8a[self.BLCOM_cfcec55a76d72def1c8adbb3a2ddae1c][BLCOM_93a5a1bb3574aa524691d5b46e5deff9] = {n = 0}; return; end if (BLCOM_57ad665d0e8800ab56a0e07f8ae9c063) then local __index, BLCOM_2361bab8b48b1041ad740bb561b21aee; for __index, BLCOM_2361bab8b48b1041ad740bb561b21aee in ipairs(BComm.BLCOM_113592aa3daac596007c6988087b5d8a[self.BLCOM_cfcec55a76d72def1c8adbb3a2ddae1c][BLCOM_93a5a1bb3574aa524691d5b46e5deff9]) do if (BLCOM_2361bab8b48b1041ad740bb561b21aee == BLCOM_57ad665d0e8800ab56a0e07f8ae9c063) then table.remove(BComm.BLCOM_113592aa3daac596007c6988087b5d8a[self.BLCOM_cfcec55a76d72def1c8adbb3a2ddae1c][BLCOM_93a5a1bb3574aa524691d5b46e5deff9], __index); if (table.getn(BComm.BLCOM_113592aa3daac596007c6988087b5d8a[self.BLCOM_cfcec55a76d72def1c8adbb3a2ddae1c][BLCOM_93a5a1bb3574aa524691d5b46e5deff9]) == 0) then BComm.BLCOM_113592aa3daac596007c6988087b5d8a[self.BLCOM_cfcec55a76d72def1c8adbb3a2ddae1c][BLCOM_93a5a1bb3574aa524691d5b46e5deff9] = nil; end return; end end else BComm.BLCOM_113592aa3daac596007c6988087b5d8a[self.BLCOM_f9da61d0483af6cef16512c8cc1a8586][BLCOM_93a5a1bb3574aa524691d5b46e5deff9] = nil; end end function BComm:UnregisterAllCommandListeners() BComm.BLCOM_113592aa3daac596007c6988087b5d8a[self.BLCOM_f9da61d0483af6cef16512c8cc1a8586] = nil; end function BComm:SendCommand(BLCOM_93a5a1bb3574aa524691d5b46e5deff9, ...) BComm:SendPriorityCommand(self.BLCOM_8e2d4ef9193eed09cc6ce5849fad1f0a, BLCOM_93a5a1bb3574aa524691d5b46e5deff9, unpack(arg)); end function BComm:SendPriorCommand(BLCOM_8e2d4ef9193eed09cc6ce5849fad1f0a, BLCOM_93a5a1bb3574aa524691d5b46e5deff9, ...) assert(BLCOM_8e2d4ef9193eed09cc6ce5849fad1f0a == "NORMAL" or BLCOM_95b28d0adb1482ad26584954d895f7ac == "BULK" or BLCOM_8e2d4ef9193eed09cc6ce5849fad1f0a == "ALERT", "Unkown priority."); ChatThrottleLib:SendAddonMessage(BLCOM_8e2d4ef9193eed09cc6ce5849fad1f0a, self.BLCOM_f9da61d0483af6cef16512c8cc1a8586, BComm.BLCOM_b162f4f29f2727948334a3a08e348df9(BLCOM_93a5a1bb3574aa524691d5b46e5deff9, unpack(arg)), self.BLCOM_a636447a4c34c16498e0f9d1b42ad9b1); end --[[ local ori_SendAddonMessage = SendAddonMessage local ori_SendChatMessage = SendChatMessage function BF_SafeSendAddonMessage(...) local _,_,wtype,target = ... if wtype =="WHISPER" then if target ~= UNKNOWN and UnitIsConnected(target) and UnitIsSameServer("player",target) then ori_SendAddonMessage(...) end else ori_SendAddonMessage(...) end end function BF_SafeSendChatMessage(...) local _,_,wtype,target = ... if wtype =="WHISPER" then else ori_SendChatMessage(...) end end SendAddonMessage = BF_SafeSendAddonMessage SendChatMessage = BF_SafeSendChatMessage ]]
